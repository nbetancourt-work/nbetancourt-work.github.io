(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[48],{4030:(a,r,l)=>{l.r(r),l.d(r,{default:()=>s});let s='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="8" height="8" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 320l512 0 0-128-512 0z" fill="#fff"/></svg>\n'},4029:(a,r,l)=>{l.r(r),l.d(r,{default:()=>s});let s='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="8" height="8" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M512 320l-192 0 0 192-128 0 0-192-192 0 0-128 192 0 0-192 128 0 0 192 192 0z" fill="#fff"/></svg>\n'},4031:(a,r,l)=>{l.r(r),l.d(r,{default:()=>s});let s='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="8" height="8" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M160 512l-160 0 0-160 64 0 0 96 96 0z m352-160l0 160-160 0 0-64 96 0 0-96z m-160-352l160 0 0 160-64 0 0-96-96 0z m-352 160l0-160 160 0 0 64-96 0 0 96z" fill="#fff"/></svg>\n'},4023:(a,r,l)=>{l.r(r),l.d(r,{Disclaimer:()=>c});var s=l(4006);function c(a,r){var l=a.container,c=a.runtime;l.selectAll(".igc-disclaimer").remove();var u=l.insert("div").attr("class","igc-disclaimer captiontext").text(r.text);c.height-=(0,s.outerHeight)(u.node())}},3914:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Map:()=>Map});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(498);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var parse_decimal_number__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3915);var parse_decimal_number__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(parse_decimal_number__WEBPACK_IMPORTED_MODULE_1__);var d3_selection__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1115);var d3_interpolate__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(3945);var d3_scale__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(3989);var d3_polygon__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(4035);var d3_dispatch__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(420);var d3_array__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(4032);var d3_time_format__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(1977);var polylabel__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(546);var polylabel__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(polylabel__WEBPACK_IMPORTED_MODULE_2__);var hammerjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3916);var hammerjs__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(hammerjs__WEBPACK_IMPORTED_MODULE_3__);var moment__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(703);var moment__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);var leaflet__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3917);var leaflet__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(leaflet__WEBPACK_IMPORTED_MODULE_5__);var leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(3918);var leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6__);var proj4leaflet__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(3919);var proj4leaflet__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(proj4leaflet__WEBPACK_IMPORTED_MODULE_7__);var _chart__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(3920);var _BarRace_controls__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(3985);var _controls_Controls__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(4013);var _helpers_legend__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(4016);var _legend_HeatmapVertical__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(4020);var _legend_Heatmap__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(4021);var _misc__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1112);var _tooltip__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1111);var _DownloadButton__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(4022);var _Disclaimer__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(4023);var _helpers_animation__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(4024);var _elements_Hint__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(3965);var _helpers_format__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(4025);var _public_js_shared_colors__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(1998);function _assert_this_initialized(a){if(void 0===a)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _class_call_check(a,r){if(!(a instanceof r))throw TypeError("Cannot call a class as a function")}function _defineProperties(a,r){for(var l=0;l<r.length;l++){var s=r[l];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,s.key,s)}}function _create_class(a,r,l){return r&&_defineProperties(a.prototype,r),l&&_defineProperties(a,l),a}function _define_property(a,r,l){return r in a?Object.defineProperty(a,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[r]=l,a}function _get(a,r,l){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,r,l){var s=_super_prop_base(a,r);if(s){var c=Object.getOwnPropertyDescriptor(s,r);return c.get?c.get.call(l||a):c.value}})(a,r,l||a)}function _get_prototype_of(a){return(_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function _inherits(a,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(r&&r.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),r&&_set_prototype_of(a,r)}function _object_spread(a){for(var r=1;r<arguments.length;r++){var l=null!=arguments[r]?arguments[r]:{};var s=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(l).filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable}))),s.forEach(function(r){_define_property(a,r,l[r])})}return a}function ownKeys(a,r){var l=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);r&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(a,r).enumerable})),l.push.apply(l,s)}return l}function _object_spread_props(a,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(l){Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(r,l))}),a}function _possible_constructor_return(a,r){return r&&("object"===_type_of(r)||"function"==typeof r)?r:_assert_this_initialized(a)}function _set_prototype_of(a,r){return(_set_prototype_of=Object.setPrototypeOf||function(a,r){return a.__proto__=r,a})(a,r)}function _super_prop_base(a,r){for(;!Object.prototype.hasOwnProperty.call(a,r)&&null!==(a=_get_prototype_of(a)););return a}function _type_of(a){return a&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a}function _is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function _create_super(a){var r=_is_native_reflect_construct();return function(){var l=_get_prototype_of(a),s;if(r){var c=_get_prototype_of(this).constructor;s=Reflect.construct(l,arguments,c)}else s=l.apply(this,arguments);return _possible_constructor_return(this,s)}}var NONDIGITCHARACTERS=["$","%","\xa3","â‚¬","<",">"];var MINHEIGHT=50;var DEFAULT_ANIMATION_LENGTH=5;var FRAMES_PER_SECOND=50;var DEFAULT_STAY_LENGTH=1;var zoomInterval;function getBounds(a){return a.reduce(function(a,r){if(!r.mapItem)return a;var l=r.mapItem.getBounds();return lodash__WEBPACK_IMPORTED_MODULE_0___default().isEmpty(l)?a:a?(a._southWest.lat=Math.min(a._southWest.lat,l._southWest.lat),a._southWest.lng=Math.min(a._southWest.lng,l._southWest.lng),a._northEast.lat=Math.max(a._northEast.lat,l._northEast.lat),a._northEast.lng=Math.max(a._northEast.lng,l._northEast.lng),a):l},null)}function labelRenderer(a){var r=a.data,l=a.style;return function(a){a.styles({bottom:0,right:0,position:"absolute",textAlign:"right"}).styles(l).style("z-index",2).text(r)}}var getOpacity=function(a,r){return a?r:r/5};function attachLegendEvents(a,r){var l=a.runtime,s=a.container;var c=l.sheet;var u=c.series.points;var p=c.style.mapFeatureOpacity;var h=(0,d3_dispatch__WEBPACK_IMPORTED_MODULE_22__.default)("legendClick","highlightStart","highlightEnd");var m=!0;var b=[];h.on("highlightStart",function(r){var l=a.map;m&&(u.enabled?(0,d3_selection__WEBPACK_IMPORTED_MODULE_23__.default)(l._container).selectAll(".leaflet-interactive").classed("__disabled",function(){return!this.classList.contains("group_"+r)&&!this.classList.contains("group_-1")}):l.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId){var l=getOpacity(r===a.feature.groupId,p);a.setStyle({fillOpacity:l})}}))}),h.on("legendClick",function(l){var c=a.map,h=a.legendData;m?(m=!1,b.push(l)):1===b.length&&b[0]===l?(m=!0,b=[]):b.includes(l)?b.splice(b.indexOf(l),1):(b.push(l),b.length===h.length&&(m=!0,b=[])),u.enabled?(0,d3_selection__WEBPACK_IMPORTED_MODULE_23__.default)(c._container).selectAll(".leaflet-interactive").classed("__disabled",function(){var a=this;var r=!m;return b.forEach(function(l){(m||a.classList.contains("group_-1")||a.classList.contains("group_".concat(l)))&&(r=!1)}),r}):c.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId){var r=b.includes(a.feature.groupId)||m;var l=getOpacity(r,p);a.feature.properties.disabled=!r,a.setStyle({fillOpacity:l})}}),h.forEach(function(a,r){a.active=m||b.includes(r)}),r.data(h),s.selectAll(".igc-legend-ico").style("background-color",function(a){return a.active?a.color:"rgba(63, 61, 56, 0.2)"})}),h.on("highlightEnd",function(){if(m){var r=a.map;u.enabled?(0,d3_selection__WEBPACK_IMPORTED_MODULE_23__.default)(r._container).selectAll(".leaflet-interactive").classed("__disabled",!1):r.eachLayer(function(a){var r;a.feature&&(null===(r=a.feature.properties)||void 0===r?void 0:r.groupId)!==-1&&a.setStyle({fillOpacity:p})})}}),r.addListener({id:a.chartId,dispatch:h})}var attribution=function(a,r){var l={wikimedia:"Map tiles: Wikimedia Maps",stamen:'Map tiles by <a href="http://stamen.com">Stamen Design</a>,\n            under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>,\n            under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',toner:'Map tiles by <a href="http://stamen.com">Stamen Design</a>,\n            under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>,\n            under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',carto:"Map tiles by Carto, under CC BY 3.0. Data by OpenStreetMap, under ODbL.",humanitarian:'Map tiles by <a href="https://www.openstreetmap.fr/mentions-legales/">OpenStreetMap France</a>,\n            under <a href="https://creativecommons.org/licenses/by-sa/2.0/deed.fr">CC BY SA</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>,\n            under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'};var s={"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png":l.wikimedia,"https://c.tile.stamen.com/watercolor/{z}/{x}/{y}.png":l.stamen,"https://b.tile.stamen.com/toner/{z}/{x}/{y}.png":l.toner,"http://c.tile.stamen.com/watercolor/{z}/{x}/{y}.png":l.stamen,"http://b.tile.stamen.com/toner/{z}/{x}/{y}.png":l.toner,"https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png":l.stamen,"https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png":l.stamen,"https://stamen-tiles.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png":l.stamen,"https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png":l.stamen,"http://a.basemaps.cartocdn.com/light_all/${z}/{x}/{y}.png":l.carto,"http://a.basemaps.cartocdn.com/dark_all/${z}/{x}/{y}.png":l.carto,"https://a.basemaps.cartocdn.com/light_all/${z}/{x}/{y}.png":l.carto,"https://a.basemaps.cartocdn.com/dark_all/${z}/{x}/{y}.png":l.carto,"https://cartocdn_{s}.global.ssl.fastly.net/base-dark/{z}/{x}/{y}.png":l.carto,"https://cartocdn_{s}.global.ssl.fastly.net/base-light/{z}/{x}/{y}.png":l.carto,"https://a.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png":l.humanitarian}[a]||"Map data by OpenStreetMap, under ODbL.";return r&&(s=s?r+" | "+s:r),'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | '.concat(s)};function calculateHeightResponsive(a,r,l,s){if(!r)return a;var c,u;if(l)u=r[1][0]-r[0][0],c=r[1][1]-r[0][1];else{var p=[s.latLng(r[0][0],r[0][1]),s.latLng(r[0][0],r[1][1]),s.latLng(r[1][0],r[0][1]),s.latLng(r[1][0],r[1][1])];c=p[0].distanceTo(p[1]),(u=p[0].distanceTo(p[2]))/(c=(c+p[2].distanceTo(p[3]))/2)>5&&(u=.75*c)}return a*Math.min(u/c,1.5)}var fixMovedLocations=function(point,transformations,getBounds){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{var _loop=function(){var transformation=_step.value;var entry={lng:point.coordinates[1],lat:point.coordinates[0]};var transform=function(transformation){var safeTransform=transformation;return safeTransform=safeTransform.replace(/entry\.lat/g,"".concat(entry.lat)),safeTransform=safeTransform.replace(/entry\.long/g,"".concat(entry.lng)),safeTransform=safeTransform.replace(/[^-()\d/*+.]/g,""),eval(safeTransform)};if(getBounds(transformation.bounds).contains([entry.lng,entry.lat]))return"string"==typeof transformation.offset[0]?entry.lng=transform(transformation.offset[0]):entry.lng+=transformation.offset[0],"string"==typeof transformation.offset[1]?entry.lat=transform(transformation.offset[1]):entry.lat+=transformation.offset[1],point.coordinates=[entry.lat,entry.lng],{v:point}};for(var _iterator=transformations[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _ret=_loop();if("object"===_type_of(_ret))return _ret.v}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return point};var overlaps=function(a,r){return r.some(function(r){return rectOverlap(r,a)})};var rectOverlap=function(a,r){return(lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(a.left,r.left,r.right)||lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(r.left,a.left,a.right))&&(lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(a.top,r.top,r.bottom)||lodash__WEBPACK_IMPORTED_MODULE_0___default().inRange(r.top,a.top,a.bottom))};function labelHTML(a){var r=a.labelColor,l=a.darkColor,s=a.lightColor,c=a.fontFamily;var u=(0,_public_js_shared_colors__WEBPACK_IMPORTED_MODULE_21__.hsl)(a.color).l<.4;var p=a.regionName.toString().replace(/</g,"&lt;");if("-"!==p){var h="font-size: ".concat(a.fontSize,"; font-style: ").concat(a.fontStyle,"; font-weight: ").concat(a.fontWeight,"; word-break: keep-all;");if(c&&(h+="font-family: ".concat(c,";")),r){var m="0 1px 0.5px ".concat(r.stroke,", 0 1px 0.5px ").concat(r.stroke,", 0 1px 0.5px ").concat(r.stroke,", 0 1px 0.5px ").concat(r.stroke,", 0 1px 0.5px");h+="color: ".concat(r.fill,"; text-shadow: ").concat(m)}else l&&(h+="color: ".concat(u?l:s,"; text-shadow: none;"));return'<div class="igc-map-marker-label" data-index="'.concat(a.dataIndex,'" style="').concat(h,'">').concat(p,"</div>")}}var _legendData_findIndex;var groupNumber=function(a,r){var l;return null!==(_legendData_findIndex=null===(l=r)||void 0===l?void 0:l.findIndex(function(r){return r.title===a}))&&void 0!==_legendData_findIndex?_legendData_findIndex:-1};var createGetEntryStyle=function(){return function(a){var r,l,s;var c=a.color||(0,_misc__WEBPACK_IMPORTED_MODULE_14__.getColor)();var u=a.stroke||"#ffffff";var p,h,m;return{fillColor:(0,_public_js_shared_colors__WEBPACK_IMPORTED_MODULE_21__.rgb)(c).toString(),color:(0,_public_js_shared_colors__WEBPACK_IMPORTED_MODULE_21__.rgb)(u).toString(),fillRule:"nonzero",fillOpacity:null!==(p=null===(r=a)||void 0===r?void 0:r.opacity)&&void 0!==p?p:1,opacity:null!==(h=null===(l=a)||void 0===l?void 0:l.strokeOpacity)&&void 0!==h?h:1,weight:null!==(m=null===(s=a)||void 0===s?void 0:s.weight)&&void 0!==m?m:1,link:a.link,dashArray:a.dashArray,className:"group_".concat(a.groupId," ")+(a.link?"igc-chart-link":"")}}};function prepareLegendData(a){var r=a.entries,l=a.sort,s=a.groupingSymbol,c=a.decimalSeparator,u=a.colors;var p=r.map(function(a){return{color:u[a.id],title:a.label,active:!0}});return"auto"!==l&&(p=sortData(p,"descending"===l,s,c)),p.map(function(a,r){return _object_spread_props(_object_spread({},a),{groupId:r})})}function sortData(a){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;var c=l&&s?"".concat(l).concat(s):",.";var u=lodash__WEBPACK_IMPORTED_MODULE_0___default().sortBy(a,function(a){return a.title});var p=!0;return u=lodash__WEBPACK_IMPORTED_MODULE_0___default().sortBy(u,function(a){var r=Date.parse(a.title);return(!r||6>lodash__WEBPACK_IMPORTED_MODULE_0___default().get(a.title,"length"))&&(p=!1),r||a.title}),p||(u=lodash__WEBPACK_IMPORTED_MODULE_0___default().sortBy(u,function(a){var r=a.title&&a.title.trim()||"";var l=!1;"-"===r[0]&&(l=!0,r=r.substr(1)),-1!==(r=(r=(r=(r=r.replace("&lt;","<")).replace("&gt;",">")).replace(/â€“/g,"-")).replace("+","")).indexOf("-")&&(r=r.split("-")[0]),-1!==NONDIGITCHARACTERS.indexOf(r[0])&&(r=r.substr(1)),-1!==NONDIGITCHARACTERS.indexOf(r.slice(-1))&&(r=r.slice(0,-1)),l&&(r="-".concat(r));var s=parse_decimal_number__WEBPACK_IMPORTED_MODULE_1___default()(r,c);return s||0===s?s:r})),r?u.reverse():u}function markerHTML(a,r,l){return'\n        <div\n            class="map-marker-container '.concat(a.link?"igc-chart-link":"",'"\n            style="opacity: ').concat(a.opacity,';"\n        >\n            <svg\n                version="1.1"\n                xmlns="http://www.w3.org/2000/svg"\n                width=').concat(a.width,"\n                height=").concat(a.height,'\n                viewBox="0 0 ').concat(a.dimensions.width," ").concat(a.dimensions.height,'"\n                class="igc-map-marker"\n            >\n                <path fill-rule="').concat(a.fillRule,'" class="igc-table-scaledpath" fill="').concat(a.color,'" d="').concat(a.path,'"/>\n            </svg>\n            ').concat(r?labelHTML(_object_spread({},a,l)):"","\n        </div>")}function formattedValue(a,r){var l=r.tooltip.x.format(a);return"NaN"===l?a:l}function redrawHeatmap(a){var r=a.container,l=a.runtime,s=a.options;if(["left","right"].includes(lodash__WEBPACK_IMPORTED_MODULE_0___default().get(l,"sheet.legend.position"))){var c=l.height;var u=r.select(".igc-legend");var p=u.select(".igc-heatmap-vertical-title-holder");var h=u.select(".igc-heatmap-scale-label-holder");var m=parseInt(lodash__WEBPACK_IMPORTED_MODULE_0___default().get(s,"style.legend.font-size"),10);var b=h.selectAll(".igc-heatmap-scale-label");var x=b.size()-1;var k=c/x;b.style("top",function(a,r){return r===x?"".concat(c-m,"px"):"".concat(r*k-m*(0===r?0:.5),"px")}),p.style("width","".concat(c,"px")),u.style("height","".concat(c,"px"))}}function createHeatmapIndexer(a){var r=a.length;return function(l){var s=0;for(var c=0;c<r;c++){var u=a[c];if(l<u)break;l>=u&&(s=c)}return s}}var Map=function(a){"use strict";_inherits(l,a);var r=_create_super(l);function l(a){var s;return _class_call_check(this,l),_define_property(_assert_this_initialized(s=r.call(this,a,"div")),"addLayerMouseEvents",function(a,r){var l=a.link,c=a.showTooltip;if(c||l){var u=_assert_this_initialized(s).tooltip;r.on({mouseover:function(){(!a.disabled||c)&&(c&&u().interaction("show"),l&&(r._map._container.style.cursor="pointer"))},mouseout:function(){c&&u().hide(),r._map._container.style.cursor=""}}),c&&r.on({mousemove:function(r){u().setText(a.text).setValue(a.displayValue).setPosition((0,_misc__WEBPACK_IMPORTED_MODULE_14__.getMousePosition)(r.originalEvent),a.color)}}),l&&r.on({click:function(){return(0,_misc__WEBPACK_IMPORTED_MODULE_14__.openUrl)(l,s.interaction)}})}}),_define_property(_assert_this_initialized(s),"getMapDimensions",function(){var a=_assert_this_initialized(s).map;var r=[];return a.eachLayer(function(a){return r.push(a)}),r.filter(function(a){return!!a.getBounds}).map(function(r){var l=r.getBounds();try{var s=a.latLngToContainerPoint(l.getNorthWest());var c=a.latLngToContainerPoint(l.getSouthEast());return{left:s.x,top:s.y,right:c.x,bottom:c.y}}catch(a){return{}}}).reduce(function(a,r){return a.left=Math.min(a.left,r.left),a.top=Math.min(a.top,r.top),a.right=Math.max(a.right,r.right),a.bottom=Math.max(a.bottom,r.bottom),a},{left:Number.MAX_VALUE,right:Number.MIN_VALUE,top:Number.MAX_VALUE,bottom:Number.MIN_VALUE})}),_define_property(_assert_this_initialized(s),"showAndHideTimelineObjects",function(){var a=function(){var a=u.data[z];if(!a.mapItem&&k.isSameOrAfter(a.start)&&!k.isSameOrAfter(a.end)){var r;var b=c?a.groupId:groupNumber(a.label,O);var x=(null===(r=O.find(function(a){return a.groupId===b}))||void 0===r?void 0:r.active)===!1;l||c||!a.feature||(a.feature.groupId=b);var C=l?leaflet__WEBPACK_IMPORTED_MODULE_5___default().marker(a.coordinates,{riseOnHover:!0,icon:leaflet__WEBPACK_IMPORTED_MODULE_5___default().divIcon({className:"map-marker group_".concat(b).concat(x?" __disabled":""),html:markerHTML(a,h,T),iconSize:[0,0]}),clickable:!0,zIndexOffset:1e3,feature:a.feature}):leaflet__WEBPACK_IMPORTED_MODULE_5___default().geoJson(a.feature,{style:m,smoothFactor:p});!l&&h&&!x&&a.regionName&&C.bindTooltip(labelHTML(_object_spread_props(_object_spread({},T),{regionName:a.regionName,color:a.color,dataIndex:z})),{permanent:!0,direction:"center",opacity:1}),C.addTo(L),s.addLayerMouseEvents.call(_assert_this_initialized(s),a,C),a.mapItem=C,D=!0}else if(a.mapItem&&(k.isAfter(a.end)||k.isBefore(a.start))){try{D=!0,L.removeLayer(a.mapItem),a.label&&L.removeLayer(a.label),delete a.label}catch(a){}delete a.mapItem}else a.start.isAfter(k)&&(I=!1);z++};var r=s.runtime,l=r.isPointsMode,c=r.isHeatmap,u=r.graph,p=r.smoothFactor,h=r.shouldShowLabels,m=r.getEntryStyle,b=r.isTimeline,x=r.sheet;var k=b?s.timeline.currentTime:s.runtime.startTime;var C=u.data.length;var S=_assert_this_initialized(s),O=S.legendData,T=S.labelStyle,L=S.map;var I=!0;var z=0;var D=!1;for(;I&&z<C;)a();if(!l&&h&&D&&s.updateLabels(),!l&&!x.view&&x.series.autoZoom){var P=getBounds(u.data)||x.series.map_json.view;P&&L.fitBounds(P)}}),_define_property(_assert_this_initialized(s),"pause",function(){clearInterval(s.timeline.timer),s.map.player.setPlaying(!1)}),_define_property(_assert_this_initialized(s),"play",function(){var a=s.timeline;a.timePassed>=a.duration&&(s.timeline.currentTime=s.timeline.startTime.clone(),s.timeline.timePassed=0),s.timeline.timer&&clearInterval(s.timeline.timer),s.timeline.timer=setInterval(s.cycle,20)}),_define_property(_assert_this_initialized(s),"cycle",function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var r=s.map.player;var l=s.timeline,c=l.step,u=l.duration,p=l.currentTime;a||(s.timeline.timePassed+=c,s.timeline.currentTime.add(c,"ms"),r.setValue(s.timeline.timePassed/u*100)),s.labelPlaceholder.text(s.runtime.parse(p.toDate())),s.showAndHideTimelineObjects(),s.timeline.currentTime.isSameOrAfter(s.timeline.endTime)&&s.pause()}),_define_property(_assert_this_initialized(s),"showZoomControls",function(){var a;var r=_assert_this_initialized(s).map;if(null===(a=r)||void 0===a?void 0:a.controls)for(var l in r.controls)r.controls[l]&&r.controls[l].addTo(r)}),_define_property(_assert_this_initialized(s),"removeZoomControls",function(){var a=_assert_this_initialized(s).map;if(a&&a.controls)for(var r in a.controls){var l;null===(l=a.controls[r])||void 0===l||l.remove()}}),_define_property(_assert_this_initialized(s),"setupLabelStyle",function(a){var r=a.style;var l=s.getSheetData();var c,u,p;return"manual"===lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.method")?c={fill:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.manual.fill"),stroke:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.manual.stroke")}:"contrast"===lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.method")&&(u=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.contrast.light"),p=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"graph.item.value.color.contrast.dark")),{fontFamily:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(l,"style.labels.regionNames.font-family"),fontSize:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"regionNames.font-size","11px"),fontStyle:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"regionNames.font-style","normal"),fontWeight:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(r,"regionNames.font-weight","400"),labelColor:c,darkColor:u,lightColor:p,visibility:s.runtime.isPointsMode?"visible":"hidden"}}),_define_property(_assert_this_initialized(s),"hideLabels",function(){var a=_assert_this_initialized(s).map;if(s.previousCenterLocation){var r=a.latLngToContainerPoint(s.centerOrigin);s.coordinateOffset={x:s.previousCenterLocation.x-r.x+s.coordinateOffset.x,y:s.previousCenterLocation.y-r.y+s.coordinateOffset.y}}else s.coordinateOffset={x:0,y:0};a.eachLayer(function(a){var r;var l=null===(r=a.getTooltip())||void 0===r?void 0:r._container;l&&(l.style.visibility="hidden")})}),s.events=(0,d3_dispatch__WEBPACK_IMPORTED_MODULE_22__.default)("startAnimation","endAnimation","tabChanged","downloadData","interaction","storePosition","updateViewbox"),s.interaction=s.createInteractionCaller(),s.tooltip=_tooltip__WEBPACK_IMPORTED_MODULE_15__.getTooltip,s}return _create_class(l,[{key:"interactionHint",value:function(){var a=this,r=a.chartId,l=a.options;var s;var c;this.touchDevice&&(s=280,c=this.interactivityHintText);var u=(0,_elements_Hint__WEBPACK_IMPORTED_MODULE_19__.Hint)().chartId(r).style(l.style.hint).width(s).text(c);(0,d3_selection__WEBPACK_IMPORTED_MODULE_23__.default)(l.container).call(u)}},{key:"render",value:function(){var a=this;var r=function(){zoomInterval=setInterval(function(){E.zoomOut()},300)};var l=function(){zoomInterval=setInterval(function(){E.zoomIn()},300)};var s=function(){clearInterval(zoomInterval)};var c,u,p,h,m,b;this.tooltip=(0,_tooltip__WEBPACK_IMPORTED_MODULE_15__.createStyledTooltip)(this);var x=leaflet__WEBPACK_IMPORTED_MODULE_5___default().Browser.mobile;var k=this,C=k.root,S=k.options,O=k.container,T=k.content;var L=this.getSheetData();L.formatter=(0,_helpers_format__WEBPACK_IMPORTED_MODULE_20__.formatHelper)(L);var I=L.style.mapFeatureOpacity;var z=L.series,D=z.osm,P=z.points;T.style("overflow","hidden"),T.attr("data-lookup","map-content");var M=!!S.editable;T.on("gesturestart",function(a){a.preventDefault(),a.stopPropagation()});var A=new(hammerjs__WEBPACK_IMPORTED_MODULE_3___default())(T.node());A.on("pinch",function(a){var r;a.preventDefault(),null===(r=a)||void 0===r||r.stopPropagation()}),A.on("swipe",function(a){a.preventDefault()});var E=this.map;var j;E&&(L.series.map_json=E.props.map_json,!M&&E.sheetIndex===this.sheetIndex&&E._lastCenter&&E._zoom&&E.props.autoZoom===L.series.autoZoom&&(j={center:E._lastCenter,zoom:E._zoom}),delete this.previousCenterLocation,E.eachLayer(function(a){return E.removeLayer(a)}),E.remove()),this.detectDimensions();var N=P.enabled;var H=null===(c=L.series.heatmap)||void 0===c?void 0:c.enabled;var V=null===(u=L.series.timeline)||void 0===u?void 0:u.enabled;H&&(this.heatmap=this.setupHeatmap(L)),V&&(this.timeToStay=this.setTimeToStay(L));var B=this.runtime={sheet:L,width:S.width,height:S.height,inanimate:(0,_helpers_animation__WEBPACK_IMPORTED_MODULE_18__.inanimated)(S),shouldShowLabels:L.series.showLabels,isHeatmap:H,isTimeline:V,isPointsMode:N,zoomInterval:null,smoothFactor:L.style.smoothFactor,getEntryStyle:createGetEntryStyle(),startTime:L.startTime,currentLayers:[]};var F=N?this.prepareSheetDataMarkers(L,leaflet__WEBPACK_IMPORTED_MODULE_5___default()):this.prepareSheetDataPolygons(L,leaflet__WEBPACK_IMPORTED_MODULE_5___default());if(V&&F.data.sort(function(a,r){return a.start.isSameOrAfter(r.start)?1:-1}),this.runtime.graph=F,this.runtime.shouldShowLabels&&(this.labelStyle=this.setupLabelStyle({style:S.style})),(0,_controls_Controls__WEBPACK_IMPORTED_MODULE_10__.Controls)(this,{width:S.width}),V&&F.data.length){(0,_misc__WEBPACK_IMPORTED_MODULE_14__.ensureElement)(C,"igc-label",this.groupTagName),this.labelPlaceholder=C.select(".igc-label");var R=L.startTime,U=L.endTime;var W=moment__WEBPACK_IMPORTED_MODULE_4___default().duration(U.diff(R)).asMilliseconds();var Z=R.clone();this.runtime.parse=(0,d3_time_format__WEBPACK_IMPORTED_MODULE_24__.timeFormat)(L.series.timeline.dataOutputFormat);var G=L.series.timeline.timelineDuration||DEFAULT_ANIMATION_LENGTH;var K=W/(G*FRAMES_PER_SECOND);labelRenderer({data:this.runtime.parse(R.toDate()),layout:{marginRight:0,marginBottom:0},style:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(S,"style.axis.x.title",{})})(this.labelPlaceholder),this.timeline={timer:null,step:K,duration:W,fps:FRAMES_PER_SECOND,currentTime:Z,startTime:R,endTime:U,timePassed:0,timelineDuration:G},(0,_BarRace_controls__WEBPACK_IMPORTED_MODULE_9__.Controls)({instance:this,width:S.width,onInput:function(r){a.timeline.currentTime=a.timeline.startTime.clone(),a.timeline.timePassed=Math.round(W*r/100),a.timeline.currentTime.add(a.timeline.timePassed,"ms"),clearInterval(a.timeline.timer),a.cycle(!0)},onPlay:function(){return a.play()},onPause:function(){return a.pause()}})}else V?(0,_BarRace_controls__WEBPACK_IMPORTED_MODULE_9__.Controls)({instance:this,width:S.width}):C.selectAll(".igc-label").remove();var Y={instance:this,sizeLimit:!1,attachEvents:function(){}};if(H)Y.creator=function(a){var r=a.instance,l=a.layout;var s;var c=r.options,u=r.runtime,p=r.content;var h=u.sheet;var m=h.series.heatmap;var b=h.legend.position;var x=l.width,k=l.side;var C=c.style.legend;return(k?_legend_HeatmapVertical__WEBPACK_IMPORTED_MODULE_12__.HeatmapVertical:_legend_Heatmap__WEBPACK_IMPORTED_MODULE_13__.Heatmap)({target:p,instance:r,pointsMode:N,data:r.legendData,width:x,maxValue:r.heatmap.maxValue,title:m.legendTitle,coldText:m.coldText,hotText:m.hotText,style:C,position:b,opacity:{active:I,disabled:getOpacity(!1,I)},layout:l.legend,showLegendValues:null===(s=h.legend)||void 0===s?void 0:s.showValues})};else{var $=(0,_helpers_legend__WEBPACK_IMPORTED_MODULE_11__.createLegendData)(this);var J=prepareLegendData({colors:L.series.groupedColors,entries:L.legendEntries,sort:L.legend.sort,groupingSymbol:L.groupingSymbol,decimalSeparator:L.decimalSeparator});var q=!0,X=!1,Q=void 0;try{for(var ee=J[Symbol.iterator](),et;!(q=(et=ee.next()).done);q=!0){var ea=et.value;$(ea)}}catch(a){X=!0,Q=a}finally{try{q||null==ee.return||ee.return()}finally{if(X)throw Q}}this.legendData=J,Y.attachEvents=attachLegendEvents}var er=(0,_helpers_legend__WEBPACK_IMPORTED_MODULE_11__.legendHelper)(Y);var eo=B.width;if(j&&(L.view=j),!S.fixedHeight){var en=calculateHeightResponsive(eo,L.series.map_json.view,L.series.latLon,leaflet__WEBPACK_IMPORTED_MODULE_5___default());B.height=leaflet__WEBPACK_IMPORTED_MODULE_5___default().Browser.mobile?Math.min(en,B.height):en}if(O.selectAll(".igc-attribution").remove(),D||L.series.map_json.attribution){var ei=attribution(D,L.series.map_json.attribution);O.append("div").classed("igc-attribution",!0).html(ei)}if(S.fixedHeight){var el=O.select(".igc-attribution");el.node()&&(B.height-=el.node().clientHeight+parseInt(el.style("margin-top"),10)),B.height=Math.max(B.height,MINHEIGHT)}!S.fixedHeight&&(H?redrawHeatmap(this):er&&er.redraw()),C.styles({width:"".concat(B.width,"px"),height:"".concat(B.height,"px")}),this.tooltip=(0,_tooltip__WEBPACK_IMPORTED_MODULE_15__.createStyledTooltip)(this);var es=L.series.map_json.disableZoom||!1===L.series.showZoom;var ec=!es&&!M&&L.series.doubleClickZoom;var eu=L.series.latLon?leaflet__WEBPACK_IMPORTED_MODULE_5___default().CRS.Simple:leaflet__WEBPACK_IMPORTED_MODULE_5___default().CRS.EPSG3857;if(null===(h=L.series.map_json)||void 0===h?void 0:null===(p=h.crs)||void 0===p?void 0:p.name){var ed=L.series.map_json.crs;eu=new(proj4leaflet__WEBPACK_IMPORTED_MODULE_7___default()).CRS(ed.name,ed.value,ed.options)}else L.crs&&(eu=new(proj4leaflet__WEBPACK_IMPORTED_MODULE_7___default()).CRS(L.crs.name,L.crs.value,L.crs.options));var ev={attributionControl:!1,zoomControl:!1,crs:eu,doubleClickZoom:ec,dragging:!x&&!es&&!M,keyboard:!x&&!M,scrollWheelZoom:!1,tap:!1,touchZoom:!es&&!M,zoomDelta:L.series.zoomDelta,zoomSnap:L.series.zoomDelta/2,preferCanvas:L.series.preferCanvas,maxZoom:18};if((E=this.map=leaflet__WEBPACK_IMPORTED_MODULE_5___default().map(C.node(),ev)).sheetIndex=this.sheetIndex,E.events=this.events,E.player=this.sheetPlayer,E.labels={},E.props=L.series,E.props.isPointsMode=N,this.container.classed("igc-map-touch",x),D){E._container.querySelector(".leaflet-tile-pane").style.opacity=L.style.tileLayerTransparency;var ep=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).TileLayer(D,{zIndex:0,reuseTiles:!0});ep.addTo(E),ep.on("load",function(){setTimeout(function(){a.events.call("startAnimation"),setTimeout(function(){a.events.call("endAnimation")},50)},B.inanimate?0:1950)})}else if(!L.series.hideBlanks){var ef=this.setupBackground(L),eh=ef.separators,em=ef.background;leaflet__WEBPACK_IMPORTED_MODULE_5___default().geoJson(em,{style:this.runtime.getEntryStyle,smoothFactor:this.runtime.smoothFactor}).addTo(E),eh.features.length&&leaflet__WEBPACK_IMPORTED_MODULE_5___default().geoJson(eh,{style:this.runtime.getEntryStyle,onEachFeature:this.addLayerMouseEvents.bind(this)}).addTo(E)}var eg;if(V||!N){if(!V&&!H){var ey=!0,eb=!1,ex=void 0;try{for(var ew=F.data[Symbol.iterator](),ek;!(ey=(ek=ew.next()).done);ey=!0){var eC=ek.value;eC.groupId=groupNumber(eC.label,this.legendData)}}catch(a){eb=!0,ex=a}finally{try{ey||null==ew.return||ew.return()}finally{if(eb)throw ex}}}F.data.length&&this.showAndHideTimelineObjects(),this.runtime.shouldShowLabels&&E.on("zoomend",function(){return a.updateLabels()}).on("zoomstart",function(){return a.hideLabels()})}else{var eS=new leaflet_markercluster__WEBPACK_IMPORTED_MODULE_6__.MarkerClusterGroup({spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,chunkedLoading:!0,maxClusterRadius:P.clusterSize,disableClusteringAtZoom:17});eg=F.data.map(function(r){var l=H?r.groupId:groupNumber(r.label,a.legendData);r.active=!0;var s=leaflet__WEBPACK_IMPORTED_MODULE_5___default().marker(r.coordinates,{riseOnHover:!0,icon:leaflet__WEBPACK_IMPORTED_MODULE_5___default().divIcon({className:"map-marker group_".concat(l),html:markerHTML(r,a.runtime.shouldShowLabels,a.labelStyle),iconSize:[0,0]}),clickable:!0,feature:r});return P.clusterSize?eS.addLayer(s):E.addLayer(s),a.addLayerMouseEvents.call(a,r,s),s}),P.clusterSize&&E.addLayer(eS),eg=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).featureGroup(eg)}var eO=L.series.autoZoom&&F.data.length&&(N?eg&&Object.keys(eg._layers).length&&eg.getBounds().pad(.05):getBounds(F.data))||L.series.map_json.view;E.defaultBounds=eO,L.view?(L.view.bounds?E.fitBounds(L.view.bounds):E.setView(L.view.center,L.view.zoom),eO=E.getBounds()):E.fitBounds(eO),E.bounds=E.getBounds(),D||E.whenReady(function(){setTimeout(function(){a.events.call("startAnimation"),setTimeout(function(){a.events.call("endAnimation")},50)},B.inanimate?0:1950)});var eT=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(S,"style.sheetSwitch.zoom");var e_=1/lodash__WEBPACK_IMPORTED_MODULE_0___default().get(S,"scale.x",1);if(E.controls={},!x&&!es){var eL=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).Control({position:"topleft"});eL.onAdd=function(){var a=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-in");var r=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(a);r.setAttribute("data-lookup","zoom-in-button");var c=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-in-icon",a);var u=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(c);return u.setAttribute("data-lookup","zoom-in-icon"),r.style.background=eT.background,u.style.webkitMaskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(4029).default),")"),u.style.maskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(4029).default),")"),u.style.backgroundColor=eT.icon,r.style.zoom=e_,leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomEvent.disableClickPropagation(a).addListener(a,"mousedown",l).addListener(a,"click",function(){E.zoomIn()}).addListener(a,"mouseover",function(){r.style.background=eT.backgroundHover,u.style.backgroundColor=eT.iconHover}).addListener(a,"mouseout",function(){r.style.background=eT.background,u.style.backgroundColor=eT.icon,s()}).addListener(a,"mouseup",s),a},E.controls.zoomIn=eL,M||eL.addTo(E);var eI=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).Control({position:"topleft"});eI.onAdd=function(){var a=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-out");var l=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(a);var c=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-zoom-out-icon",a);var u=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(c);return l.style.background=eT.background,u.style.webkitMaskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(4030).default),")"),u.style.maskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(4030).default),")"),u.style.backgroundColor=eT.icon,l.style.zoom=e_,leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomEvent.disableClickPropagation(a).addListener(a,"click",function(){E.zoomOut()}).addListener(a,"mouseover",function(){l.style.background=eT.backgroundHover,u.style.backgroundColor=eT.iconHover}).addListener(a,"mouseout",function(){l.style.background=eT.background,u.style.backgroundColor=eT.icon,s()}).addListener(a,"mousedown",r).addListener(a,"mouseup",s),a},E.controls.zoomOut=eI,M||eI.addTo(E);var ez=new(leaflet__WEBPACK_IMPORTED_MODULE_5___default()).Control({position:"topleft"});ez.onAdd=function(){var a=this;var r=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-restore ".concat(!x&&!M&&"__hidden"||"__upsized"));var l=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(r);var s=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.create("div","leaflet-control-restore-icon",r);var c=leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomUtil.get(s);return l.style.background=eT.background,c.style.webkitMaskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(4031).default),")"),c.style.maskImage="url(data:image/svg+xml;utf8,".concat(encodeURIComponent(__webpack_require__(4031).default),")"),c.style.backgroundColor=eT.icon,l.style.zoom=x?1.5*e_:e_,leaflet__WEBPACK_IMPORTED_MODULE_5___default().DomEvent.disableClickPropagation(r).addListener(r,"click",function(r){if(M?E.fitBounds(E.defaultBounds):E.fitBounds(E.bounds),a.viewportUnchanged=!0,!x){var l,s;r.currentTarget.classList.add("__hidden"),null===(s=ez)||void 0===s||null===(l=s.getContainer())||void 0===l||l.classList.toggle("__hidden",!0)}},r).addListener(r,"mouseover",function(){l.style.background=eT.backgroundHover,c.style.backgroundColor=eT.iconHover}).addListener(r,"mouseout",function(){l.style.background=eT.background,c.style.backgroundColor=eT.icon}),r},E.controls.restorePosition=ez,M||ez.addTo(E),this.viewportUnchanged=!0,E.on("contextmenu",s).on("drag",function(){return E.fire("moveend")}).on("movestart",function(){a.tooltip().hide()}).on("moveend",function(){try{a.viewportUnchanged=E.getBounds(!0).equals(E.bounds)}catch(r){a.viewportUnchanged=!1}if(!x){var r,l;null===(l=ez)||void 0===l||null===(r=l.getContainer())||void 0===r||r.classList.toggle("__hidden",a.viewportUnchanged)}})}(null===(b=L.series.map_json)||void 0===b?void 0:null===(m=b.meta)||void 0===m?void 0:m.disclaimer)&&(0,_Disclaimer__WEBPACK_IMPORTED_MODULE_17__.Disclaimer)(this,L.series.map_json.meta.disclaimer),(0,_DownloadButton__WEBPACK_IMPORTED_MODULE_16__.DownloadButton)(this,S.style.legend)}},{key:"updateLabels",value:function(){var a=this;setTimeout(function(){var r=a.map;a.centerOrigin=r.getCenter(),a.previousCenterLocation=r.latLngToContainerPoint(a.centerOrigin),r.eachLayer(function(l){var s;var c=null===(s=l.getTooltip())||void 0===s?void 0:s._container;if(c){var u=c.firstChild.getBoundingClientRect();c.style["margin-top"]=-(u.height/2)+"px",c.style["margin-left"]=-(u.width/2)+"px";var p=l._layers[Object.keys(l._layers)[0]]._pxBounds;var h=p&&p.max.x-p.min.x>30&&p.max.y-p.min.y>20;if(h){var m,b;var x=parseInt(c.firstChild.getAttribute("data-index"),10);var k=a.runtime.graph.data[x].feature;var C=k.geometry.coordinates;if("MultiPolygon"===k.geometry.type){var S=(0,d3_array__WEBPACK_IMPORTED_MODULE_25__.default)(C.map(function(a){return-(0,d3_polygon__WEBPACK_IMPORTED_MODULE_26__.default)(a[0])}));C=C[S]}var O=polylabel__WEBPACK_IMPORTED_MODULE_2___default()(C).reverse();var T=r.latLngToContainerPoint(O);var L;var I;c.style.left=T.x+(null!==(L=null===(m=a.coordinateOffset)||void 0===m?void 0:m.x)&&void 0!==L?L:0)+"px",c.style.top=T.y+(null!==(I=null===(b=a.coordinateOffset)||void 0===b?void 0:b.y)&&void 0!==I?I:0)+"px"}c.style.visibility=h?"visible":"hidden"}});var l=[];r.eachLayer(function(a){var r;var s=null===(r=a.getTooltip())||void 0===r?void 0:r._container;if(s&&"hidden"!==s.style.visibility){var c=s.firstChild.getBoundingClientRect();overlaps(c,l)?s.style.visibility="hidden":l.push(c)}})},50)}},{key:"defaults",value:function(){return lodash__WEBPACK_IMPORTED_MODULE_0___default().merge({},_get(_get_prototype_of(l.prototype),"defaults",this).call(this),{animation:{duration:500}})}},{key:"emptySheetData",value:function(){return lodash__WEBPACK_IMPORTED_MODULE_0___default().merge({},_get(_get_prototype_of(l.prototype),"emptySheetData",this).call(this),{legend:{enabled:!1},series:{heatmap:{enabled:!1},points:{enabled:!1},map_json:{features:[]}},style:{}})}},{key:"setupBackground",value:function(a){var r=a.series,l=r.map_json,s=r.osm;var c=l.features,u=l.meta;var p=a.style,h=p.inactive,m=p.mapFeatureOpacity,b=p.strokeWidth,x=p.strokeOpacity;var k={type:"Feature",geometry:{type:"MultiPolygon",coordinates:[]},stroke:p.strokeColor,color:h,weight:Math.min("number"==typeof b?b:lodash__WEBPACK_IMPORTED_MODULE_0___default().get(l,"featureStrokeWidth",s?2:1),.5),strokeOpacity:x,opacity:m,groupId:-1};var C={type:"FeatureCollection",features:[]};var S=!0,O=!1,T=void 0;try{var L=this,I=function(){var r=D.value;var l=r.geometry.coordinates;if("border"===r.properties.type){var s=L.separatorDefaultStyle(l,u,a.style.inactive);if(r.properties.dashArray&&(s.properties.dashArray=r.properties.dashArray),r.properties.strokeWidth&&(s.properties.strokeWidth=r.properties.strokeWidth),r.properties.boundFeature){var p=c.find(function(a){return a.properties.name===r.properties.boundFeature});s.properties=lodash__WEBPACK_IMPORTED_MODULE_0___default().extend({},p.properties,s.properties),delete s.properties.groupId,s.properties.type="border"}C.features.push(s)}else{var h=k.geometry.coordinates;if("Polygon"===r.geometry.type)h.push(l);else{var m=!0,b=!1,x=void 0;try{for(var S=l[Symbol.iterator](),O;!(m=(O=S.next()).done);m=!0){var T=O.value;h.push(T)}}catch(a){b=!0,x=a}finally{try{m||null==S.return||S.return()}finally{if(b)throw x}}}}};for(var z=l.features[Symbol.iterator](),D;!(S=(D=z.next()).done);S=!0)I()}catch(a){O=!0,T=a}finally{try{S||null==z.return||z.return()}finally{if(O)throw T}}return{background:k,separators:C}}},{key:"separatorDefaultStyle",value:function(a,r,l){var s,c,u,p,h,m,b,x;var k,C,S,O;return{geometry:{type:null!==(k=null===(c=r)||void 0===c?void 0:null===(s=c.border)||void 0===s?void 0:s.separatorType)&&void 0!==k?k:"MultiLineString",coordinates:[a]},properties:{hideLabel:!0,stroke:null!==(C=null===(p=r)||void 0===p?void 0:null===(u=p.border)||void 0===u?void 0:u.stroke)&&void 0!==C?C:l,weight:null!==(S=null===(m=r)||void 0===m?void 0:null===(h=m.border)||void 0===h?void 0:h.strokeWeight)&&void 0!==S?S:1.5,dashArray:null!==(O=null===(x=r)||void 0===x?void 0:null===(b=x.border)||void 0===b?void 0:b.dashArray)&&void 0!==O?O:"0",opacity:0,groupId:-1},type:"Feature"}}},{key:"setupHeatmap",value:function(a){var r=a.series.heatmap,l=r.heatmapEntries,s=r.hotColor,c=r.coldColor;var u=a.series.limits||a.defaultLimits;var p=[];var h=[];var m=(0,d3_scale__WEBPACK_IMPORTED_MODULE_27__.default)().domain(u).range(u).ticks(l);var b=a.formatter.axis.x.createTickFormatter(m,a.axis[0]);var x=m.map(function(a){return b(a)});var k=x.length;for(var C=0;C<k-1;C++)p[C]=(0,d3_interpolate__WEBPACK_IMPORTED_MODULE_28__.default)(c,s)(C/(k-2)),h[C]={text:x[C],color:p[C],groupId:C};var S=function(a){var r=createHeatmapIndexer(m);return function(l){return Math.min(a,r(l))}}(p.length-1);return this.legendData=h,{colors:p,index:S,heatmapValues:x,maxValue:x[k-1],ticks:m}}},{key:"prepareSheetDataPolygons",value:function(a){var r;var l=a.series,s=l.data,c=l.localisation,u=l.osm,p=l.map_json,h=l.groupedData;var m=a.style,b=m.colors,x=m.strokeWidth,k=m.mapFeatureOpacity,C=m.strokeOpacity;var S=a.tooltip;var O=this.runtime,T=O.isHeatmap,L=O.isTimeline;var I;var z=void 0!==x?x:(null!==(I=null===(r=p)||void 0===r?void 0:r.featureStrokeWidth)&&void 0!==I?I:u)?2:1;var D=this.tooltipEnabled();var P=h?"group":"title";var M=0;var A=!0,E=!1,j=void 0;try{var N=this,H=function(){var r=B.value;var l=p.features.find(function(a){return a.properties.name===r.key});if(!l||""===r.value&&T)return"continue";if(r.feature=lodash__WEBPACK_IMPORTED_MODULE_0___default().cloneDeep(l),T){var s=N.heatmap.index(r.valueNumber);r.feature.groupId=s,r.color=r.feature.color=N.heatmap.colors[s]}else{var m=r[P];!a.series.groupedColors[m]&&(a.series.groupedColors[m]=(0,_misc__WEBPACK_IMPORTED_MODULE_14__.getColor)(M,b),M++),r.color=r.feature.color=a.series.groupedColors[m],r.feature.groupedData=h,r.feature.groupId=-1}r.displayValue=(r.value&&S.showValue?formattedValue(r.value,a.formatter)+"\n":"")+r.text,r.regionName=r.feature.regionName=c?l.properties[c]:r.label||r.title,r.label=h?r.group:c?l.properties[c]:r.label||r.title,r.groupName=!1!==S.showGroupNames?r.group:null,r.showTooltip=D,D&&(r.text=r.regionName+(r.groupName?"\n"+r.groupName:"")),r.feature.weight=z,r.feature.opacity=k,r.feature.strokeOpacity=C,r.feature.stroke=u?r.color:a.style.strokeColor,delete r.active,L&&a.series.timeline.fixedStayTime&&(r.end=r.start.clone().add(N.timeToStay))};for(var V=s[Symbol.iterator](),B;!(A=(B=V.next()).done);A=!0)H()}catch(a){E=!0,j=a}finally{try{A||null==V.return||V.return()}finally{if(E)throw j}}return{data:s,colors:b}}},{key:"prepareSheetDataMarkers",value:function(a,r){var l=this;var s;var c=this.runtime,u=c.isHeatmap,p=c.isTimeline;var h=a.series,m=h.data,b=h.osm,x=h.map_json,k=h.points,C=h.groupedData,S=h.groupedColors;var O=k.pointSizemin,T=k.pointSizemax,L=k.shape;var I=a.tooltip,z=a.formatter;var D=a.style,P=D.markerOpacity,M=D.colors;var A=x.corrections;var E=C?"group":"title";var j=0;return{data:Object.values(m).filter(function(a){return a.coordinates[0]&&a.coordinates[1]&&(""!==a.value||!u)}).map(function(s){!b&&A&&(s=fixMovedLocations(s,A,r.bounds));var c=u?T:Math.round(Math.max(O,T*Math.sqrt(s.relativeValue)));var h=Math.round(L.dimensions.height*c/L.dimensions.width);var m=s[E];var x;var k=-1;var D=C?s.group:s.label;if(u){var N=l.heatmap.colors;var H=N.length;var V=Math.floor(H*s.relativeValue);V>=H?V=H-1:V<0&&(V=0),x=N[V],k=V}!S[m]&&(S[m]=(0,_misc__WEBPACK_IMPORTED_MODULE_14__.getColor)(j,M),j++);var B=x||S[m];var F=l.tooltipEnabled();var R=I.showValue&&null!==s.value?formattedValue(s.value,z)+"\n":"";var U;return F&&(U=s.label,s.group&&!1!==I.showGroupNames&&(U+="\n"+s.group)),p&&a.series.timeline.fixedStayTime&&(s.end=s.start.clone().add(l.timeToStay)),{color:B,coordinates:s.coordinates,dimensions:L.dimensions,groupId:k,groupName:C?s.group:"",label:D,link:s.link,name:s[E],regionName:s.label,showTooltip:F,text:U,displayValue:R+s.text,path:L.path,height:h,opacity:P,scale:c/L.dimensions.width,verticalOffset:L.verticalOffset,width:c,start:s.start,end:s.end,fillRule:L.fillRule}}),colors:M,maxValue:null===(s=this.heatmap)||void 0===s?void 0:s.maxValue}}},{key:"setTimeToStay",value:function(a){var r=a.startTime,l=a.endTime;return moment__WEBPACK_IMPORTED_MODULE_4___default().duration(l.diff(r)).asMilliseconds()*(a.series.timeline.stayLength||DEFAULT_STAY_LENGTH)/(a.series.timeline.timelineDuration||DEFAULT_ANIMATION_LENGTH)}},{key:"applySheetOptions",value:function(a){var r=function(r){return a[r]||a[0]};a&&this.options.sheets.forEach(function(a,l){var s=r(l+1);s.axis&&lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.axis,s.axis),s.legend&&lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.legend,s.legend),s.series&&lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.series,s.series),s.style&&(a.style=a.style||{},lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.style,s.style)),s.tooltip&&(a.tooltip=a.tooltip||{},lodash__WEBPACK_IMPORTED_MODULE_0___default().merge(a.tooltip,s.tooltip)),a.view=s.view})}}],[{key:"getClassName",value:function(){return"Map"}}]),l}(_chart__WEBPACK_IMPORTED_MODULE_8__.Chart)},4013:(a,r,l)=>{l.r(r),l.d(r,{Controls:()=>h});var s=l(4010);var c=l(4011);var u=l(4014);var p={tab:s.TabSwitcher,player:c.Player,radio:u.RadioSwitcher};function h(a){var r;var l;p[null!==(l=null===(r=a.options.sheetSwitch)||void 0===r?void 0:r.type)&&void 0!==l?l:"radio"].apply(null,arguments)}},4014:(a,r,l)=>{l.r(r),l.d(r,{RadioSwitcher:()=>x});var s=l(498);var c=l.n(s);var u=l(1115);var p=l(4015);var h=l(4011);var m=l(4005);function b(a){var r=a.insert("span").attr("class","igc-sm-sheet-switch-radio").style("visibility","hidden").style("position","absolute").style("top","0px").style("left","0px").append("div").attr("class","igc-sheets").append("div").attr("class","igc-sheet").append("span").attr("class","igc-sheet-ico").node().offsetWidth;return a.select(".igc-sm-sheet-switch-radio").remove(),r}function x(a,r){var l=a.container,s=a.options,x=a.sheetIndex;var k=s.sheets;var C=".igc-content";var S=a.interaction;if((0,h.removeSheetPlayer)(a),l.selectAll(".igc-sheets").remove(),!(0,m.sheetsEmpty)(a)){var O=c().get(s,"style.sheetSwitch.radio");var T=b(l);var L=(0,p.TextItemMetrics)().width(r.width).texts(k.map(function(a){return a.categories.title})).style(O).parentContainer(l).reservedSize(T+20)();var I=l.insert("div",C).attr("class","igc-sheets").attr("role","radiogroup").attr("aria-label","select sheet").style("width","".concat(r.width,"px"));var z=I.selectAll(".igc-sheet").data(k.map(function(a,r){return{name:a.categories.title,sheetIndex:r}}));(z=z.merge(z.enter().append("div"))).attr("class","igc-sheet").attr("role","radio").attr("aria-checked",function(a){return a.sheetIndex===x?"true":"false"}).attr("aria-labelledby",function(a){return"igc-sheet-label".concat(a.sheetIndex)}).attr("class",function(a){return a.sheetIndex===x?"igc-sheet active":"igc-sheet"}).style("max-width","".concat(L.width,"px")),z.append("span").attr("class","igc-sheet-ico").attr("role","presentation").attr("id",function(a){return"igc-sheet-".concat(a.sheetIndex)}),z.append("span").attr("class","igc-sheet-label").html(function(a){return a.name}).attr("id",function(a){return"igc-sheet-label".concat(a.sheetIndex)}).styles(O).style("height","".concat(L.label.height,"px")).style("max-width","".concat(L.label.width,"px")),z.on("click",function(r,s){var c=(0,u.default)(this);S("sheetSwitch.item","click"),a.sheetIndex!==s.sheetIndex&&(l.selectAll(".igc-sheet.active").attr("class","igc-sheet").attr("aria-checked","false"),c.classed("active",!0).attr("aria-checked","true"),a.sheetIndex=s.sheetIndex,delete a.legendData,a.render())}),(0,m.subtractHeight)(a,I.node())}}},4021:(a,r,l)=>{l.r(r),l.d(r,{Heatmap:()=>h,HeatmapEntryEvents:()=>m});var s=l(498);var c=l.n(s);var u=l(1115);var p=l(1112);function h(a){var r=a.data,l=void 0===r?[]:r,s=a.coldText,h=void 0===s?"":s,b=a.maxValue,x=void 0===b?"":b,k=a.instance,C=a.hotText,S=void 0===C?"":C,O=a.opacity,T=void 0===O?{active:1,disabled:.2}:O,L=a.showLegendValues,I=void 0===L||L,z=a.style,D=void 0===z?{}:z,P=a.layout,M=a.target,A=a.title,E=void 0===A?"":A,j=a.width,N=void 0===j?300:j,H=a.pointsMode,V=void 0!==H&&H;return function(a){var r=c().get(D,"color.label.customColor")||c().get(D,"color.label.active");var s=c().omit(P,["entry"]);a.each(function(){var a=(0,u.default)(this);a.styles((0,p.kebabizeObject)(s)),a.style("width","".concat(N,"px"));var b=a.append("div").attr("class","igc-heatmap-label igc-legend-label").styles(D).style("color",r);b.append("div").attr("class","igc-heatmap-label-text").text(E);var C=I?b:a;var O=a.append("div").attr("class","igc-heatmap-entries").selectAll(".igc-heatmap-item").data(l);var L=O.enter().append("div").attr("class","igc-heatmap-item");if(L.style("background-color",function(a){return a.color}),m({g:a,entry:O=O.merge(L),instance:k,opacity:T,target:M,pointsMode:V}),I){var z=a.append("div").attr("class","igc-heatmap-values").styles({height:c().get(D,"font-size"),color:r});l.push({text:x});var P=z.selectAll(".igc-heatmap-value").data(l);var A=P.enter().append("div").attr("class","igc-heatmap-value");A.text(function(a){return a.text});var j=A.nodes().map(function(a){return a.getBoundingClientRect().width/2});A.styles(function(a,r){return r===l.length-1?{right:0}:0===r?{left:0}:{left:"".concat(N*r/(l.length-1)-j[r],"px")}}),A.styles(D),P=P.merge(A),C.append("div").attr("class","igc-heatmap-limit __cold").styles(D).text(h),C.append("div").attr("class","igc-heatmap-limit __hot").styles(D).text(S);var H=a.selectAll(".igc-heatmap-value");var B=[];H.each(function(){var a=(0,u.default)(this).node().getBoundingClientRect();B.push(a)});var F=B.length;var R=B[0].right;var U=B[F-1].left;var W=!1;var Z=1;for(;!W&&Z<F;){var G=R;W=!0;for(var K=Z;K<F-1;K+=Z){if(B[K].left<G||B[K].right>U){Z++,W=!1;break}G=B[K].right}}H.classed("__hidden",function(a,r){return 0!==r&&r!==F-1&&r%Z!=0})}})}}function m(a){var r=a.g,l=a.entry,s=a.instance,c=a.opacity,p=a.target,h=a.pointsMode;var m=c.active,b=c.disabled;var x=s.interaction;var k=l.size();var C=!0;var S=[];l.on("click",function(a,r){var l=r.groupId;var c=s.map,u=s.canvasLayer;C?(C=!1,S.push(l)):1===S.length&&S[0]===l?(C=!0,S=[]):S.includes(l)?S.splice(S.indexOf(l),1):(S.push(l),S.length===k&&(C=!0,S=[])),h?u?u.enableGroups(S):p.selectAll(".leaflet-interactive").classed("__disabled",function(){var a=this;var r=!C;return S.forEach(function(l){(C||a.classList.contains("group_".concat(l)))&&(r=!1)}),this.classList.contains("group_-1")&&(r=!1),r}):c.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId&&"border"!==a.feature.type){var r=S.includes(a.feature.groupId)||C;var l=r?m:b;a.feature.disabled=!r,a.setStyle({fillOpacity:l})}}),p.selectAll(".igc-heatmap-item").classed("__disabled",function(a,r){return!(C||S.includes(r))}),x("heatmap.legend","click")}).on("mouseover",function(a,l){if(C){var c=l.groupId;var p=s.map,k=s.canvasLayer;h?k?k.enableGroups([c]):(0,u.default)(r.node().parentNode).selectAll(".leaflet-interactive").classed("__disabled",function(){return!(this.classList.contains("group_".concat(c))||this.classList.contains("group_-1"))}):p.eachLayer(function(a){if(a.feature&&-1!==a.feature.groupId&&"border"!==a.feature.type){var r=c===a.feature.groupId?m:b;a.setStyle({fillOpacity:r})}})}x("heatmap.legend","hover")}).on("mouseout",function(){if(C){var a=s.map,l=s.canvasLayer;h?l?l.enableGroups([]):(0,u.default)(r.node().parentNode).selectAll(".leaflet-interactive").classed("__disabled",!1):a.eachLayer(function(a){a.feature&&-1!==a.feature.groupId&&"border"!==a.feature.type&&a.setStyle({fillOpacity:m})})}})}},4020:(a,r,l)=>{l.r(r),l.d(r,{HeatmapVertical:()=>S});var s=l(498);var c=l.n(s);var u=l(1115);var p=l(4019);var h=l(4017);var m=l(4015);var b=l(1112);var x=l(4021);function k(a,r,l){return r in a?Object.defineProperty(a,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[r]=l,a}function C(a){var r=[];var l;a.each(function(){var a=(0,u.default)(this).node().getBoundingClientRect();r.push(a),l=a});var s=r[0].bottom;var c=l.top;var p=r.length;var h=!1;var m=1;for(;!h&&m<p;){var b=s;h=!0;for(var x=m;x<p-1;x+=m){if(r[x].top<b||r[x].bottom>c){m++,h=!1;break}b=r[x].bottom}}return m}function S(a){var r=a.data,l=void 0===r?[]:r,s=a.coldText,S=void 0===s?"":s,O=a.maxValue,T=void 0===O?"":O,L=a.instance,I=a.hotText,z=void 0===I?"":I,D=a.opacity,P=void 0===D?{active:1,disabled:.2}:D,M=a.position,A=void 0===M?h.LEGEND_POSITION.LEFT:M,E=a.showLegendValues,j=void 0===E||E,N=a.style,H=void 0===N?{}:N,V=a.layout,B=a.target,F=a.title,R=void 0===F?"":F,U=a.width,W=void 0===U?300:U;var Z=function(a){var r=a.selectAll(".igc-heatmap-scale-entry").data(l).enter().append("div").attr("class","igc-heatmap-scale-entry");return r.style("height","".concat(100/et,"%")).style("background-color",function(a){return a.color}),(0,x.HeatmapEntryEvents)({g:(0,u.default)(r.node().parentNode),entry:r,instance:L,opacity:P,target:B}),r};var G=function(a){if(!j)return 5;var r=a.append("div").attr("class","igc-heatmap-scale-label-holder");var s=eo/et;var c=l.map(function(a,r){return{text:a.text,offset:r*s-ea*(0===r?0:.5)}});c.push({text:T,offset:eo-ea});var u=r.selectAll(".igc-heatmap-scale-label").data(c).enter().append("div").attr("class","igc-heatmap-scale-label");var h=(0,m.createMeasurement)({container:J,lineHeight:1,style:H})(c.map(function(a){return a.text}));var b=(0,p.default)(h,function(a){return a.width});u.text(function(a){return a.text}).styles(H),u.styles({top:function(a){return"".concat(a.offset,"px")}});var x=C(u);return er&&u.classed("__right",er),u.classed("__hidden",function(a,r){return 0!==r&&r%x!=0}),b+5};var K=function(a){if(!S&&!z)return 0;var r=a.append("div").attr("class","igc-heatmap-vertical-title-holder").style("width","".concat(eo,"px"));r.classed("__right",er);var l=S&&z;var s=[z||"",S||""];er&&s.reverse();var c=0;return s.forEach(function(a,s){if(a){var u=r.append("span");u.classed("igc-heatmap-vertical-title",!0),u.classed("__top",0===s),u.classed("__bottom",1===s),u.classed("__fullsize",!l),u.styles(H),u.style("color",X),u.text(a),c=Math.max(c,u.node().offsetHeight)}}),c+=4,r.style("height","".concat(c,"px")),c};var Y=function(a){return a.append("div").attr("class","igc-heatmap-vertical-slot")};var $=function(a){eo=L.runtime.height;var r=c().omit(V,["entry"]);a.each(function(){var a=(0,u.default)(this);a.styles((0,b.kebabizeObject)(r)),a.style("color",X);var l=ee;a.style("width","".concat(W,"px")),a.style("height","".concat(eo,"px"));var s=Y(a);var c=Y(a);var p=Y(a);var h=s;var m=p;er&&(h=p,m=s),l=K(h)||l,h.style("width","".concat(l,"px")),c.style("width","".concat(Q,"px")),m.style("width","".concat(W-Q-l,"px")),Z(c);var x=G(m);m.style("width","".concat(x,"px"));var C=l+Q+x;if(q.width+=W-C,R){var S=a.append("div").attr("class","igc-heatmap-vertical-slot __heading").styles(H).style("color",X).text(R);S.styles(k({width:"".concat(q.width,"px")},er?"right":"left","".concat(C,"px"))),q.height-=S.node().offsetHeight}a.style("width","".concat(C,"px"))})};var J=L.content,q=L.runtime;var X=c().get(H,"color.label.customColor")||c().get(H,"color.label.active");var Q=13;var ee=10;var et=l.length;var ea=parseInt(c().get(H,"font-size"),10);var er=h.LEGEND_POSITION.RIGHT===A;var eo;return $}},4015:(a,r,l)=>{l.r(r),l.d(r,{TextItemMetrics:()=>h,createMeasurement:()=>p});var s=l(3964);var c=l(1112);function u(a,r){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return a.append("span").styles(r).style("white-space","nowrap").style("line-height",l).style("visibility","hidden").style("position","absolute").style("top","0px").style("left","0px")}function p(a){var r=a.style,l=a.container,s=a.lineHeight;return function(a){var p=u(l,r,s);var h=(0,c.measureTextHtml)(a,p.node());return p.remove(),h}}function h(){var a=function(){if(m){var a=u(m,p);var s=(0,c.measureTextHtmlHeight)(r,a.node());return a.remove(),{width:l,label:{width:l-h,height:s+s/4}}}};var r=[];var l=300;var p=(0,s.chartOptions)().style.legend;var h=0;var m;var b={texts:function(l){return arguments.length?(r=l.slice(0),a):r},width:function(r){return arguments.length?(l=r,a):l},style:function(r){return arguments.length?(p=r,a):p},reservedSize:function(r){return arguments.length?(h=r,a):h},parentContainer:function(r){return arguments.length?(m=r,a):m}};return Object.assign(a,b),a}},1111:(a,r,l)=>{l.r(r),l.d(r,{createStyledTooltip:()=>b,getTooltip:()=>m,setTooltip:()=>h,tooltipDummy:()=>u});var s=l(1112);var c=l(843);var u={setText:function(){return this},setValue:function(){return this},setPosition:function(){return this},show:function(){return(0,c.logError)("Trying to show dummy tooltip"),this},interaction:function(){return this},hide:function(){return p!==u&&p.hide.apply(p,arguments),this},mute:function(){return this},unmute:function(){return this},isVisible:function(){return this},setKey:function(){return this},getKey:function(){return this}};var p=u;function h(a){p=a}function m(){return p}function b(a){var r,l,c,p,h,b,x,k,C,S,O;var T=a.createInteractionCaller();var L=null===(c=a)||void 0===c?void 0:null===(l=c.options)||void 0===l?void 0:null===(r=l.tooltip)||void 0===r?void 0:r.enabled;var I=null===(x=a)||void 0===x?void 0:null===(b=x.options)||void 0===b?void 0:null===(h=b.style)||void 0===h?void 0:null===(p=h.tooltip)||void 0===p?void 0:p.text;var z=null===(O=a)||void 0===O?void 0:null===(S=O.options)||void 0===S?void 0:null===(C=S.style)||void 0===C?void 0:null===(k=C.tooltip)||void 0===k?void 0:k.value;return function(a,r,l,s){return l?function(){return{setText:function(r){return m().setText(r,a),this},setValue:function(a){return"string"!=typeof a||m().setValue(a,r),this},setPosition:function(a,r){return m().setPosition(a,{color:r,scale:s().x}),this},interaction:function(a){return T("tooltip",a),this},show:function(){return m().show.apply(m(),arguments),this},hide:function(){return m().hide.apply(m(),arguments),this},isVisible:function(){return m().isVisible()},mute:function(){return m().mute(),this},unmute:function(){return m().unmute(),this},setKey:function(){return m().setKey.apply(m(),arguments),this},getKey:function(){return m().getKey()}}}:function(){return u}}(I=I&&(0,s.camelizeObject)(I),z=z&&(0,s.camelizeObject)(z),L,(0,s.createGetScale)(a.root.node()))}},7439:(a,r,l)=>{l.r(r),l.d(r,{default:()=>z});var s=l(498);var c=l.n(s);var u=l(3914);var p=l(2012);var h=l(7276);var m=l(1987);var b=l(7314);var x=l(7282);var k=l(7284);var C=l(749);function S(a,r,l,s,c,u,p){try{var h=a[u](p);var m=h.value}catch(a){l(a);return}h.done?r(m):Promise.resolve(m).then(s,c)}function O(a){return function(){var r=this,l=arguments;return new Promise(function(s,c){var u=a.apply(r,l);function p(a){S(u,s,c,p,h,"next",a)}function h(a){S(u,s,c,p,h,"throw",a)}p(void 0)})}}function T(a,r){var l,s,c,u,p={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return u={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function h(a){return function(r){return m([a,r])}}function m(u){if(l)throw TypeError("Generator is already executing.");for(;p;)try{if(l=1,s&&(c=2&u[0]?s.return:u[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,u[1])).done)return c;switch(s=0,c&&(u=[2&u[0],c.value]),u[0]){case 0:case 1:c=u;break;case 4:return p.label++,{value:u[1],done:!1};case 5:p.label++,s=u[1],u=[0];continue;case 7:u=p.ops.pop(),p.trys.pop();continue;default:if(!(c=(c=p.trys).length>0&&c[c.length-1])&&(6===u[0]||2===u[0])){p=0;continue}if(3===u[0]&&(!c||u[1]>c[0]&&u[1]<c[3])){p.label=u[1];break}if(6===u[0]&&p.label<c[1]){p.label=c[1],c=u;break}if(c&&p.label<c[2]){p.label=c[2],p.ops.push(u);break}c[2]&&p.ops.pop(),p.trys.pop();continue}u=r.call(a,p)}catch(a){u=[6,a],s=0}finally{l=c=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var L=Object.assign({},h.default);var I=["edit","capture","download","thumbnail"];L.instanceClass=u.Map,L.initialize=function(){var a=O(function(a){return T(this,function(r){switch(r.label){case 0:return[4,(0,p.loadMapData)(a.chart)];case 1:return r.sent(),[2,h.default.initialize.call(this,a)]}})});return function(r){return a.apply(this,arguments)}}(),L.setupChartOptionsDimensions=function(){var a=this,r=a.custom,l=a.chartOptions,s=a.viewMode;c().get(r,"height")&&(l.height=parseInt(r.height,10),l.fixedHeight=!0),l.editable="edit"===s},L.setupChartSheetOptionsItem=function(a){var r,l,s,u,h,S,O,T,L,z,D,P,M;var A=m.default.shapes;var E=a.heatmap,j=a.points,N=a.osm;var H=this,V=H.charts,B=H.viewMode;var F=this.custom.map_json;var R=(null===(s=this)||void 0===s?void 0:null===(l=s.charts)||void 0===l?void 0:null===(r=l.map)||void 0===r?void 0:r.labels)||{};R.regionNames&&(R.regionNames=(0,b.toKebabCase)(R.regionNames));var U=c().merge([],this.themeColors,a.colors||this.colors);var W={};for(var Z in a.groupedColors)try{W[decodeURIComponent(Z)]=a.groupedColors[Z]}catch(r){W[Z]=a.groupedColors[Z]}if(document)for(var G in W)W[G]=(0,C.replaceCssVarsInColor)(W[G],document);if(F.corrections&&N){var K=!0,Y=!1,$=void 0;try{for(var J=F.features[Symbol.iterator](),q;!(K=(q=J.next()).done);K=!0){var X=q.value;X.geometry.coordinatesOriginal&&(X.geometry.coordinates=X.geometry.coordinatesOriginal)}}catch(a){Y=!0,$=a}finally{try{K||null==J.return||J.return()}finally{if(Y)throw $}}}var Q,ee,et,ea,er,eo;var en={axis:[{},{}],legend:{align:c().get(a,"labels.legend.align",c().get(this,"charts.legend.align","top")),enabled:a.showLegend,position:c().get(a,"labels.legend.position",c().get(this,"charts.legend.position","bottom")),showValues:c().get(a,"showLegendValues",!0),sort:a.sort||"auto"},series:{heatmap:{enabled:E},points:{enabled:j},timeline:a.timeline,groupedData:a.groupedData,groupedColors:W,map_json:F,doubleClickZoom:-1===I.indexOf(B),preferCanvas:"capture"!==B,autoZoom:a.autoZoom,hideBlanks:!j&&a.hideBlanks,latLon:a.latLon,localisation:a.localisation,osm:(0,p.getTileLayer)(a.osm,null===(h=this.charts)||void 0===h?void 0:null===(u=h.map)||void 0===u?void 0:u.osm),showZoom:a.showZoom,mobileInteractivityHint:a.mobileInteractivityHint,showLabels:a.showNames,zoomDelta:null!==(Q=null===(T=this)||void 0===T?void 0:null===(O=T.charts)||void 0===O?void 0:null===(S=O.map)||void 0===S?void 0:S.zoomDelta)&&void 0!==Q?Q:.2},style:{colors:U,inactive:a.inactive||(null===(L=V.map)||void 0===L?void 0:L.countryFill)||"#eeeeee",labels:c().merge({},R,a.labels),strokeColor:a.polygonStrokeColor||c().get(V,"map.polygonStrokeColor","#ffffff"),smoothFactor:"capture"===B?.1:.2,mapFeatureOpacity:(null!==(et=null!==(ee=a.mapFeatureOpacity)&&void 0!==ee?ee:F.featureOpacity)&&void 0!==et?et:N?50:100)/100,markerOpacity:(null!==(ea=null===(z=a)||void 0===z?void 0:z.markerOpacity)&&void 0!==ea?ea:100)/100,strokeOpacity:(null!==(er=null===(D=a)||void 0===D?void 0:D.strokeOpacity)&&void 0!==er?er:100)/100,strokeWidth:a.mapItemStrokeWidth,tileLayerTransparency:(null!==(eo=a.tileLayerTransparency)&&void 0!==eo?eo:100)/100},tooltip:{showValue:c().get(a,"showValue",!0),showGroupNames:c().get(a,"showGroupNames",c().get(V,"map.showGroupNames",!0))},view:a.view};if(E){var ei,el,es,ec;en.series.heatmap=c().merge(en.series.heatmap,{coldColor:a.coldColor||(null===(ei=V.map)||void 0===ei?void 0:ei.coldColor)||en.style.inactive,hotColor:a.hotColor||(null===(el=V.map)||void 0===el?void 0:el.hotColor)||U[0],hotText:(null===(es=a.hotText)||void 0===es?void 0:es.toString())||"",coldText:(null===(ec=a.coldText)||void 0===ec?void 0:ec.toString())||"",legendTitle:a.legendTitle,heatmapEntries:a.heatmap_entries}),document&&(en.series.heatmap.coldColor=(0,C.replaceCssVarsInColor)(en.series.heatmap.coldColor,document),en.series.heatmap.hotColor=(0,C.replaceCssVarsInColor)(en.series.heatmap.hotColor,document))}if(j){var eu=A[a.path]||A.circlePath;eu.verticalOffset=c().get(eu,"dimensions.stickToBottom")?-1:-.5,en.series.points=c().merge(en.series.points,{shape:eu,pointSizemax:a.pointSizemax||30,pointSizemin:c().get(a,"pointSizemin",5),clusterSize:a.clusterSize||0})}if(null===(M=en.series)||void 0===M?void 0:null===(P=M.timeline)||void 0===P?void 0:P.enabled){var ed,ev,ep,ef,eh,em,eg;var ey="%Y-%m-%d";var eb;en.series.timeline.dataInputFormat=(null===(ev=a)||void 0===ev?void 0:null===(ed=ev.dataInputFormat)||void 0===ed?void 0:ed.date)||ey,en.series.timeline.dataOutputFormat=null!==(eb=null===(eg=a)||void 0===eg?void 0:null===(em=eg.labels)||void 0===em?void 0:null===(eh=em.axis)||void 0===eh?void 0:null===(ef=eh.x)||void 0===ef?void 0:null===(ep=ef.tick)||void 0===ep?void 0:ep.timeFormat)&&void 0!==eb?eb:en.series.timeline.dataInputFormat,"auto"===en.series.timeline.dataOutputFormat&&(en.series.timeline.dataOutputFormat=en.series.timeline.dataInputFormat)}return Number.isFinite(a.xmin)&&Number.isFinite(a.xmax)&&a.xmin!==a.xmax&&(en.series.limits=[a.xmin,a.xmax]),(0,x.assignAxisTickInterval)(en,a),(0,x.assignAxisTicks)(en,a),(0,k.assignNumberFormatValues)({sheetOptions:en,custom:a,axis:[{id:"x",path:""},{id:"x1",path:"axis.x"}],inputDecimalSeparator:this.inputDecimalSeparator}),(0,k.assignNumberFormatLabels)({sheetOptions:en,custom:a,affixes:[{id:"x",path:""},{id:"label",path:""}],inputDecimalSeparator:this.inputDecimalSeparator}),en};let z=Object.freeze(L)},7282:(a,r,l)=>{l.r(r),l.d(r,{assignAxisInverse:()=>k,assignAxisLimits:()=>m,assignAxisTickInterval:()=>x,assignAxisTicks:()=>b,assignAxisTitles:()=>h,assignCategoryLabelLayout:()=>C});var s=l(498);var c=l.n(s);var u=["x","y","y2"];var p=["min","max"];function h(a,r,l){var s=!0,c=!1,p=void 0;try{for(var h=l[Symbol.iterator](),m;!(s=(m=h.next()).done);s=!0){var b=m.value;a.axis[u.indexOf(b)].title=r["".concat(b,"label")]||""}}catch(a){c=!0,p=a}finally{try{s||null==h.return||h.return()}finally{if(c)throw p}}}function m(a,r,l){var s=!0,c=!1,h=void 0;try{for(var m=l[Symbol.iterator](),b;!(s=(b=m.next()).done);s=!0){var x=b.value;var k=!0,C=!1,S=void 0;try{for(var O=p[Symbol.iterator](),T;!(k=(T=O.next()).done);k=!0){var L=T.value;var I=r["".concat(x).concat(L)];"number"==typeof I&&(a.axis[u.indexOf(x)]["".concat(L,"Limit")]=I)}}catch(a){C=!0,S=a}finally{try{k||null==O.return||O.return()}finally{if(C)throw S}}}}catch(a){c=!0,h=a}finally{try{s||null==m.return||m.return()}finally{if(c)throw h}}}function b(a,r){a.axis.forEach(function(a,l){a.ticks=c().get(r,"labels.axis.".concat(u[l],".tick.enabled"),!0)})}function x(a,r){a.axis.forEach(function(a,l){var s=c().get(r,"axis.".concat(u[l],".ticks"));void 0!==s&&(a.tickInterval=s)})}function k(a,r,l){var s=u.indexOf(l);c().set(a,"axis[".concat(s,"].invert"),c().get(r,"axis.".concat(l,".invert"),!1))}function C(a,r){"tilted"===r.categoryLayout&&c().set(a,"categories.layout","tilted")}},7284:(a,r,l)=>{l.r(r),l.d(r,{assignNumberFormatLabels:()=>b,assignNumberFormatValues:()=>m});var s=l(498);var c=l.n(s);var u=l(1991);var p={label:{libraryTargetPath:"labels.format",customAffixPath:"labels.graph.item.format.affix"},x:{libraryTargetPath:"tooltip.format.x",customAffixPath:"labels.tooltip.format.x.affix"},y:{libraryTargetPath:"tooltip.format.y",customAffixPath:"labels.tooltip.format.y.affix"},y2:{libraryTargetPath:"tooltip.format.y2",customAffixPath:"labels.tooltip.format.y2.affix"}};function h(a,r,l){var s=r.decimalSeparator,p=r.groupingSymbol;p&&c().set(a,"grouping","none"===p?"":p);var h=!1===s;c().set(a,"decimal",h?".,":s);var m=l?new u.default("firstNumber",l):new u.default(h?"legacy":"firstNumber",s);c().set(a,"numberParser",m)}function m(a){var r=a.sheetOptions,l=a.custom,s=a.axis,u=a.inputDecimalSeparator;var p={x:0,y:1,y2:2,x1:0,y1:1};s.forEach(function(a){var s=a.id,m=a.path;var b=m?c().get(l,m,{}):l;var k=r.axis[p[s]];c().has(k,"format")||c().set(k,"format",{});var C=k.format;if(x(C,b),!["x1","y1"].includes(s)){h(C,b,u);var S=["useSIPrefixes"];c().get(l,"axis.".concat(s,".affix"),!0)&&S.push("prefix","suffix"),S.forEach(function(a){var r=c().get(b,a);void 0!==r&&c().set(C,a,r)})}})}function b(a){var r=a.sheetOptions,l=a.custom,s=a.affixes,u=void 0===s?[]:s,m=a.inputDecimalSeparator;u.forEach(function(a){var s=a.id,u=a.path,b=a.ignoreCheck,k=a.defaultValue;var C=p[s];var S=C.libraryTargetPath,O=C.customAffixPath;var T=u?c().get(l,u,{}):l;var L=c().pick(T,"prefix","suffix");x(L,T),h(L,T,m),b||c().get(l,O,k)||(c().unset(L,"prefix"),c().unset(L,"suffix")),c().set(r,S,L)})}function x(a,r){var l=r.decimalPlaces,s=r.decimalPlacesValue;l&&void 0!==s&&c().set(a,"decimalPlaces",s)}},7314:(a,r,l)=>{l.r(r),l.d(r,{toKebabCase:()=>u});var s=l(498);var c=l.n(s);function u(a){return Object.keys(a).reduce(function(r,l){return r[c().kebabCase(l)]=a[l],r},{})}}}]);