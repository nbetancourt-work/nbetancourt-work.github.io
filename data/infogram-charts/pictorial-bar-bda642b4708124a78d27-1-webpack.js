(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[49],{7383:(t,e,a)=>{a.r(e),a.d(e,{PictorialBar:()=>O});var r=a(498);var i=a.n(r);var n=a(7248);var o=a(7273);var l=a(3975);var s=a(4016);var c=a(4013);var h=a(4024);var u=a(7377);var v=a(4025);var p=a(1112);var f=a(7376);var d=a(7259);var g=a(1111);var y=a(4022);var m=a(1997);function b(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e,a){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(a||t):i.value}})(t,e,a||t)}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var O=function(t){"use strict";var e;!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(r,t);var a=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t=k(r),a;if(e){var i=k(this).constructor;a=Reflect.construct(t,arguments,i)}else a=t.apply(this,arguments);var n;return(n=a)&&("object"==(n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof n)?n:function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(this)});function r(t){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),a.call(this,t,"div")}var f,O;return O=[{key:"getClassName",value:function(){return"PictorialBar"}}],f=[{key:"render",value:function(){var t=this;this.detectDimensions();var e=this.options,a=this.root;var r=new d.Renderer({instance:this});var i=this.getSheetData();var p=(0,v.formatHelper)(i);var f=this.runtime={width:e.width,height:e.height,inanimate:(0,h.inanimated)(e),sheet:i,formatter:p};var g={top:10,right:10,bottom:10,left:10,pictorial:1};var m=this.prepareSheetData(i);var b=m.data;this.sizeMultiplier=1,a.select(".igc-pictorial-bar-visual").remove();var w=f.svg=a.append("svg").attr("class","igc-pictorial-bar-visual");this.groupTagName="g",(0,c.Controls)(this,{width:e.width}),(0,y.DownloadButton)(this,e.style.legend);var k=(0,s.legendHelper)({instance:this});if(!this.sheetsNotFound()){var x=e.series.showText?b[0].text:"";var O=this.createAnimationCounter(2);var S=e.style.graph.item.value;var D=f.width-g.left-g.right;var C=f.height-g.top-g.bottom;var B=f.height;var j=this.setupBarText(x,m.colors,S);var P={width:Math.round(D/2),height:Math.round(C)};var M=parseInt(S["font-size"],10);var T=this.drawBarText(j,P,g,M,!1,m.textLink);var R=P.height-T.height;R>=0?j.styles({top:g.top+R/2+"px"}):(C+=Math.abs(R),B+=Math.abs(R)),T.width>0&&(D-=T.width+10);var A=i.categories.shapes;A.length||(A=this.defaults().shapes.map(function(t){return t.title}));var E=Object.values(A=(0,u.availableShapesMetrics)(e.shapes)(A)).reduce(function(t,e){return t.width=Math.max(t.width,e.bbox.width+g.pictorial),t.height=Math.max(t.height,e.bbox.height),t},{width:0,height:0});var I=this.getValueSum(b);var _=Math.min(D/I/E.width,C/E.height);var z={cols:Math.min(I,Math.floor(D/(E=Object.values(A=this.initShapesScaled(A,_)).reduce(function(t,e){return t.width=Math.max(t.width,e.bbox.width+g.pictorial),t.height=Math.max(t.height,e.bbox.height),t},{width:0,height:0})).width)),rows:1,cellMetrics:E};z.cellCount=z.rows*z.cols,z.colPosition=(0,o.default)().domain((0,n.default)(0,z.cols)).range([0,D]).padding(0),z.rowPosition=(0,o.default)().domain((0,n.default)(0,z.rows)).range([(C-E.height)/2,C]).padding(0),z.realNumbers=!1;var L=m.data=this.getShapeDataScattered(i,b,z,A,I);m.overlayData=this.getShapeGroupOverlayPaths(b,L,z),this.prepareShapes(A,_);var N={igc:{x:g.left,y:g.top}};this.containerSetup(),w.attr("width",f.width).attr("height",B);var H=w.select(".igc");r.add(function(){w.datum(t).transition().ease(l[e.animation.ease]).duration(e.animation.duration).on("start",function(){t.events.call("startAnimation")}).on("end",function(){O()}),H.attr("transform","translate(".concat(N.igc.x,", ").concat(N.igc.y,")"))}),r.addGraph([{graphs:[m],transitionDuration:e.animation.duration,legend:k,originalScale:_,animationEnd:O}]),r.start()}}},{key:"prepareSheetData",value:function(t){var e=t.categories.shapes;var a=this.getSheetColors();var r=t.series[0];var i="".concat(r.rawData[0]);var n=-1!==(0,p.replaceBlank)(i).indexOf("%");var o={value:(0,p.replaceBlank)(Math.abs(r.data[0]),0),valueLabel:(0,p.replaceBlank)(r.rawData[3]),category:(0,p.replaceBlank)(r.rawData[2]),text:(0,p.replaceBlank)(r.rawData[3]),shape:e[0],categoryIdx:0,link:r.links?r.links[0]:null};var l={value:(0,p.replaceBlank)(Math.abs(r.data[1]),0),valueLabel:(0,p.replaceBlank)(r.rawData[3]),category:(0,p.replaceBlank)(""),shape:e[0],categoryIdx:1,link:r.links?r.links[1]:null};return n?(o.value=l.value*(o.value/100),l.value-=o.value):o.value>l.value?l.value=0:(o.value=l.value-(l.value-o.value),l.value-=o.value),(0,s.createLegendData)(this)({color:a[0],title:o.category,groupId:0}),o.value===l.value&&0===o.value&&(l.value=1),{type:r.type,data:[o,l],colors:a,textLink:r.links?r.links[3]:null}}},{key:"getSheetColors",value:function(){var t=this.runtime;var e=i().get(t,"sheet");var a=i().get(e,"categories");var r=i().get(e,"series[0].index",0);var n=a.inactiveColor;var o=a.inactiveColorAlpha;return void 0!==o&&(n=m.Colors.rgbStrToRgbaStr(n,o)),[i().get(a,"colors[".concat(r,"]")),n]}},{key:"initShapesScaled",value:function(t,e){return Object.keys(t).reduce(function(a,r){var i=t[r].shape;var n=(0,p.measurePath)(i,e);return a[r]={shape:i,bbox:n},a},{})}},{key:"prepareShapes",value:function(t,e){var a=this.runtime.svg;a.selectAll("defs").data([0]).enter().append("defs");var r=a.select("defs");Object.keys(t).forEach(function(a){var i=t[a],n=i.shape,o=i.fillRule;var l="igc-cp-"+a+this.chartId;r.selectAll("#"+l).data([0]).enter().append("clipPath").attr("id",l).selectAll("path").data([0]).enter().append("path").attr("d",n).attr("fill-rule",o),r.selectAll("#"+l).attr("transform","scale("+e+")")},this)}},{key:"graphInstanceSetup",value:function(t,e,a,r,i){var n=e.data.length;var o=this.runtime.formatter;var l=(0,h.removeDelay)(this,function(t,e){return e/n*500});t.data(e.data).overlayData(e.overlayData).colors(e.colors).groupId(i).highlightFirstOnly(!0).tooltip((0,g.createStyledTooltip)(this)).tooltipText(function(t){return t.category}).tooltipValue(function(t){return o.tooltip.x.format(t.valueLabel)}).transitionDelay(l).transitionDuration(r.transitionDuration),t.dispatch().on("animationEnd",r.animationEnd)}},{key:"setupBarText",value:function(t,e,a){var r=this.root,n=this.options;var o=".igc-pictorial-bar-text-container";var l=n.style.graph.item.value;r.select(o).remove();var s=r.insert("div",".igc-pictorial-bar-visual").attr("class",o.slice(1));s.styles({width:"".concat(this.runtime.width,"px")});var c=i().pick(a,["font-family","font-weight","font-style"]);return s.append("div").attr("class","igc-pictorial-bar-text").text(t).styles(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};var r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),r.forEach(function(e){var r;r=a[e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r})}return t}({position:"absolute",color:l.color||e[0]},c))}},{key:"drawBarText",value:function(t,e,a,r,i,n){var o=this.interaction;t.styles({"font-size":"".concat(r,"px"),top:"".concat(a.top,"px"),right:"".concat(a.right,"px")}),t.style("width",null),i&&t.style("width","".concat(e.width,"px"));var l={width:t.node().offsetWidth,height:t.node().offsetHeight};return l.width>e.width?this.drawBarText(t,e,a,r,!0,n):l.height>e.height&&r>11?(r--,this.drawBarText(t,e,a,r,!1,n)):(t.classed("igc-chart-link",!!n).on("click",function(){(0,p.openUrl)(n,o)}),l)}},{key:"containerSetup",value:function(){var t=this.runtime.svg;t.selectAll("defs").data([0]).enter().append("defs");var e=t.selectAll(".igc").data([0]);e.merge(e.enter().append("g").attr("class","igc"))}},{key:"defaults",value:function(){var t={};return i().merge(t,w(k(r.prototype),"defaults",this).call(this),{style:{graph:{item:{value:{"font-size":"60px"}}}}}),i().unset(t,"style.graph.item.value.color"),t}},{key:"emptySheetData",value:function(){return i().merge({},w(k(r.prototype),"emptySheetData",this).call(this),{categories:{inactiveColor:"#959595"}})}},{key:"applySheetOptions",value:function(t){t&&this.options.sheets.forEach(function(e,a){var r=t[a+1]||t[0];r.categories&&i().merge(e.categories,r.categories),e.series.forEach(function(t){"bar"===t.type&&r.bar&&i().merge(t,r.bar)}),r.legend&&i().merge(e.legend,r.legend),e.iconSizeMultiplier=1})}}],b(r.prototype,f),O&&b(r,O),r}(f.PictorialGrid)},7382:(t,e,a)=>{a.r(e),a.d(e,{default:()=>u});var r=a(498);var i=a.n(r);var n=a(1112);var o=a(7383);var l=a(7375);var s=a(7276);var c=a(7277);var h=Object.assign({},s.default);h.instanceClass=o.PictorialBar,h.defaultHeight=100,h.setupChartOptions=function(){s.default.setupChartOptions.call(this);var t=this.custom;this.chartOptions.series.showText=!i().has(t,"showText")||t.showText},h.setupChartOptionsStyle=function(){s.default.setupChartOptionsStyle.call(this);var t=i().merge({},(0,n.kebabizeObject)(i().get(this.charts,"pictorialBar.style",{})));var e=i().get(this,"custom.labels.graph.item.value.font-family");var a=i().get(t,"graph.item.value.font-family");e?i().unset(t,"graph.item.value.font-family"):a&&i().set(t,"graph.item.value.font-family",a),i().merge(this.chartOptions.style,t)},h.setupChartSheetOptionsItem=function(t){var e=i().get(this,"charts.pictorialBar.colors.background");var a=t.inactive||e||"#959595";var r={categories:{colors:i().merge([],this.themeColors,t.colors||this.colors),inactiveColor:a,inactiveColorAlpha:i().get(t,"inactiveAlpha",1)}};(0,c.default)(r,t,this.charts);var n=t.path;return l.addShapesToCharts.call(this,n),r.categories.shapes=[(0,l.cleanShapeName)(n)],r};let u=Object.freeze(h)}}]);